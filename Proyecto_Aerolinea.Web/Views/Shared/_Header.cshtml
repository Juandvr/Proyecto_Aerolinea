@using Proyecto_Aerolinea.Web.Data.Entities
@inject Proyecto_Aerolinea.Web.Services.Abstract.IUserService _userService

@{
    User? user;

    try
    {
        user = await _userService.GetUserByEmailAsync(User.Identity.Name);
    }
    catch
    {
        user = null;
    }
}

<header id="header" class="header d-flex align-items-center fixed-top">
    <div class="header-container container-fluid container-xl position-relative d-flex align-items-center justify-content-between">

        <a asp-controller="Home" asp-action="Index" class="logo d-flex align-items-center me-auto me-xl-0">
            <!-- Uncomment the line below if you also wish to use an image logo -->
            <!-- <img src="assets/img/logo.webp" alt=""> -->
            <h1 class="sitename">Tour</h1>
        </a>

        <nav id="navmenu" class="navmenu">
            <ul>
                @* <li><a asp-controller="Home" asp-action="Index">Home</a></li> *@
                <li><a href="about.html">About</a></li>
                <li><a asp-controller="Flights" asp-action="Available">Vuelos</a></li>
                <li><a asp-controller="Airports" asp-action="Index">Aeropuertos</a></li>
                <li><a href="gallery.html">Gallery</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li class="dropdown">
                    <a href="#"><span>More Pages</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
                    <ul>
                        <li><a href="destination-details.html">Destination Details</a></li>
                        <li><a href="tour-details.html">Tour Details</a></li>
                        <li><a href="booking.html">Booking</a></li>
                        <li><a href="testimonials">Testimonials</a></li>
                        <li><a href="faq.html">Frequently Asked Questions</a></li>
                        <li><a href="blog-details.html">Blog Details</a></li>
                        <li><a href="terms.html">Terms</a></li>
                        <li><a href="privacy.html">Privacy</a></li>
                        <li><a href="404.html">404</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#"><span>Dropdown</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
                    <ul>
                        <li><a href="#">Dropdown 1</a></li>
                        <li class="dropdown">
                            <a href="#"><span>Deep Dropdown</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
                            <ul>
                                <li><a href="#">Deep Dropdown 1</a></li>
                                <li><a href="#">Deep Dropdown 2</a></li>
                                <li><a href="#">Deep Dropdown 3</a></li>
                                <li><a href="#">Deep Dropdown 4</a></li>
                                <li><a href="#">Deep Dropdown 5</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Dropdown 2</a></li>
                        <li><a href="#">Dropdown 3</a></li>
                        <li><a href="#">Dropdown 4</a></li>
                    </ul>
                </li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
            <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
        </nav>
        @if (user is not null)
        {
            <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
                <!--<img src="~/assets/img/person/avatar.png" alt="Profile" class="rounded-circle">-->
                <span class="d-none d-md-block dropdown-toggle ps-2">@user.FirstName.Substring(0, 1) . @user.LastName</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
                        <li class="dropdown-header"">
                            <span>@user.ProjectRole.Name</span>
                        </li>
                <li>
                    <a class="dropdown-item d-flex align-items-center" asp-action="UpdateUser" asp-controller="Account">
                        <i class="bi bi-gear"></i>
                        <span>Editar</span>
                    </a>
                </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                <li>
                    <a class="dropdown-item d-flex align-items-center" asp-action="Logout" asp-controller="Account">
                        <i class="bi bi-box-arrow-right"></i>
                        <span>Cerrar sesión</span>
                    </a>
                </li>
            </ul>
        }
        else
        {
            <a class="btn-getstarted" asp-controller="Account" asp-action="Login">Get Started</a>
        }

    </div>
</header>
